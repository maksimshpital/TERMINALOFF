#include <stdio.h>
#include <stdlib.h>
#pragma warning(disable:4996)

int main() {
  int n, k;
  printf("Введите размерность: \n");
  scanf("%d", &n);
  printf("Введите число векторов: \n");
  scanf("%d", &k);
  double** a = NULL;

  a = (double**)malloc(n * sizeof(double *));
  for (int i = 0; i < n; i++) {
    a[i] = (double*)malloc(k * sizeof(double));
  }

  printf("Введите координаты векторов: \n");
  for (int i = 0; i < k; i++)
    for (int p = 0; p < n; p++) {
      float l;
      scanf("%f", &l);
      a[p][i] = l;
    }

  for (int i = 0; i < k; i++) {
    for (int p = i; p < n; p++) {
      if (fabs(a[p][i]) < pow(10, -15)) {
        for (int tt = i; tt < k; tt++) {
          if (a[p][tt] != 0) {
            for (int u = 0; u < n; u++) {
              double m = a[u][i];
              a[u][i] = a[u][tt];
              a[u][tt] = m;
            }
            break;
          }
        }
      }

      if (a[p][i] != 0)
        break;
    }
  }

  for (int i = 0; i < k - 1; i++) {
    if (a[i][i] != 0) {
      for (int tt = i + 1; tt < k; tt++) {
        double alfa = a[i][tt] / a[i][i];
        for (int u = 0; u < n; u++) {
          a[u][tt] = a[u][tt] - a[u][i] * alfa;
        }
      }
    }
  }
  int r = 0;
  for (int tt = 0; tt < k; tt++) {
    for (int i = 0; i < n; i++) {
      if (a[i][tt] != 0) {
        r++;
        break;
      }
    }
  }

  printf("Ранг равен %d \n", r);

  for (int i = 0; i < n; i++) {
    free(a[i]);
  }
  free(a);

  return 0;
}
